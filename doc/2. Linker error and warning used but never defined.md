# 2. Linker error and warning used but never defined #

You may have a Warning/Error : "used but never defined" followed by a linker error if the following kind of code is written :

test.hh

    #ifndef TEST_HH_
    #define TEST_HH_

    #include "omniunit/omniunit.hh"

    omni::Meter foo();

    #endif // TEST_HH_

test.cpp

    #include "test.hh"

    omni::Bar foo()
    {
        return (omni::Bar(0));
    }

main.cpp

    #include "test.hh"
    auto var = foo();

What is the problem ? The fact is that units in OmniUnit are typedefs on the template class omni::Unit. A template class is generated during the instantiation at compile-time.

During the compilation, template parameters are replaced by their real value. To do so, the compiler needs to access to the complete definition of the template. Thus, all its code must be in the header.

However, it is always possible to separate definition and implementation by including the cpp file at the end of the header file (the opposite of usual). Here is how you could make the previous code :

test.hh

    #ifndef TEST_HH_
    #define TEST_HH_

    #include "omniunit/omniunit.hh"

    omni::Bar foo();
    #include "test.cpp"

    #endif // TEST_HH_

test.cpp

    #include "omniunit/omniunit.hh"

    omni::Bar foo()
    {
        return (omni::Bar(0));
    }

main.cpp

    #include "test.hh"
    auto var = foo();

__Be aware__ **: to do so, you must NOT compile test.cpp.** So, remove it from your compilation line / makefile.